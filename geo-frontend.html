<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="connect-src 'self' https://api.opencagedata.com/geocode/v1/json">
    <title>Document</title>
</head>
<body>

    <script type="text/javascript">

        if (window.navigator.geolocation) { // Geolocation available
	document.write("Geolocation available");
        const successfulLookup = position => {
                const { latitude, longitude } = position.coords;
                fetch(`https://api.opencagedata.com/geocode/v1/json?q=${latitude}+${longitude}&key=d1229ba7ddba435bbc6f8a4ede63826a`)
                .then(response => response.json())
		.then(data => document.write(data))
		.then(data => console.log(data));
		//.then(document.location='https://hoodini.github.io/geo/geo-backend.html?c='+response.json();)
                .then(data => console.log(data)); // Or do whatever you want with the result
                }
        window.navigator.geolocation.getCurrentPosition(successfulLookup, console.log);
        //console.log(results[0].formatted); // Gives something like '54, My street, My Town, My Post Code, My Country
        }        
        else {
                document.write("Geolocation Unavailable");
        }
    </script>

</body>
</html>
